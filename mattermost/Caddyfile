:8066 {
	@options method OPTIONS
	@originacc header Origin https://app.acc.clothingloop.org
	@originprod header Origin https://app.acc.clothingloop.org

	header {
		>Access-Control-Allow-Methods POST, GET, OPTIONS, PUT, PATCH, DELETE
		>Access-Control-Allow-Credentials true
	}
	header @originacc {
		>Access-Control-Allow-Origin https://app.acc.clothingloop.org
		>Access-Control-Allow-Headers origin,content-type,x-requested-with,accept,token,Authorization
	}
	header @originprod {
		>Access-Control-Allow-Origin https://app.clothingloop.org
		>Access-Control-Allow-Headers origin,content-type,x-requested-with,accept,token,Authorization
	}

	respond @options 204

	reverse_proxy http://mattermost:8065 {
		stream_timeout 24h
		stream_close_delay 5m
		header_up Host {host}
		header_up X-Real-IP {remote_host}
		header_up X-Forwarded-For {remote_host}
		header_up X-Forwarded-Proto {scheme}
	}
}
